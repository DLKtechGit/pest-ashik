"use strict";(self.webpackChunkpest_admin=self.webpackChunkpest_admin||[]).push([[202],{81325:function(e,t,n){var i=n(66585);t.Z={createTechnician:e=>i.Z.Post("technician/createTechnician",e),technicianList:e=>i.Z.Get("technician/getTechnician",e),technicianTask:e=>i.Z.Get("task/getTasks",e),createTechnicianTask:e=>i.Z.Post("task/createTask",e),DeleteTechinician:e=>{let t=`technician/delete/${e}`;return i.Z.Post(t)},DeletedTechnician:e=>i.Z.Get("technician/all/deletedTechnician",e),RestoreTechnician:e=>{const t=`technician/delete/technician/${e}`;return i.Z.Post(t)},TechnicianCount:e=>i.Z.Get("company/totalTechnician",e),StartTaskCount:e=>i.Z.Get("task/start/taskcount",e),OngoingTaskCount:e=>i.Z.Get("task/ongoing/taskcount",e),CompletedTaskCount:e=>i.Z.Get("task/completed/taskcount",e),RegisterTechnicican:e=>i.Z.Post("otherauth/technicianRegister",e),EditTechnician:e=>{const t=`technician/editTechnician/${e.id}`;return i.Z.Post(t,e)},GetReports:e=>i.Z.Get("task/completedTaskDetails/",e),deleteTask:e=>i.Z.Post("task/delete/task",e)}},61202:function(e,t,n){n.r(t);var i=n(47313),a=(n(31046),n(33497)),s=n(57884),r=n(22834),l=n(71820),c=n(67118),o=n(81325),d=n(70816),h=n.n(d),u=n(86893),m=(n(88379),n(65213)),g=n(97890),x=n(46417);t.default=()=>{const[e]=s.Z.useForm(),[t,n]=(0,i.useState)([]),[d,v]=(0,i.useState)([]),[p,f]=(0,i.useState)(""),[S,j]=(0,i.useState)(""),[y,T]=(0,i.useState)(new Date),[C,N]=(0,i.useState)(""),[k,b]=(0,i.useState)(""),[w,Z]=(0,i.useState)(""),[D,$]=(0,i.useState)(null),[M,A]=(0,i.useState)(""),[I,W]=(0,i.useState)([]),[G,L]=(0,i.useState)([]),[P,R]=(0,i.useState)([]),[F,E]=(0,i.useState)(!1),H=(0,g.s0)(),[Y,q]=(0,i.useState)(1),[Q,_]=(0,i.useState)(10);(0,i.useEffect)((()=>{"true"===localStorage.getItem("login")?J():H("/")}),[]),(0,i.useEffect)((()=>{if(null!==d&&void 0!==d&&d.customerAvailble){const e=d.endTime;j(e),O()}}),[d,S]);const O=()=>{const[e,t]=p.split(":").map(Number),[n,i]=S.split(":").map(Number);let a=n-e,s=i-t;return s<0&&(a--,s+=60),b(a),N(s),{hours:a,minutes:s}},U=[],z=t.map((e=>e.QrCodeCategory.length>0?e.QrCodeCategory[0]:e.noqrcodeService[0])).map((e=>e.subCategoryStatus)).map((e=>e)).map((e=>e.map((e=>e.pauseDetails))));for(let i=0;i<z.length;i++){const e=z[i][0];U.push(e)}(0,i.useEffect)((()=>{U.length>0&&W(U)}),[t]);const B=I.map((e=>e.map((e=>e.pauseReason))));(0,i.useEffect)((()=>{L(B)}),[I]);const J=async()=>{E(!0);try{const e=await o.Z.technicianTask(),t=e.data.Results.reduce(((e,t)=>{var n;return e.push(...null===(n=t.technicians[0])||void 0===n?void 0:n.tasks),e}),[]),i=t.filter((e=>"completed"===e.status)).reverse();n(i)}catch(e){console.error("Error fetching tasks:",e)}finally{E(!1)}},K=[{title:"S.No",dataIndex:"sNo",width:"5%",render:(e,t,n)=>(Y-1)*Q+n+1},{title:"Service Name",dataIndex:"QrCodeCategory",width:"8%",render:(e,t)=>{var n,i,a,s;return(0,x.jsx)(x.Fragment,{children:e&&e.length>0?(0,x.jsxs)(x.Fragment,{children:[e.map(((e,t)=>(0,x.jsx)("div",{className:"mb-2",children:(0,x.jsxs)("div",{children:[(0,x.jsxs)("div",{className:"fonts13 textLeft",style:{fontWeight:"700",textAlign:"left"},children:[e.category," :"]}),e.subCategory.map(((e,t)=>(0,x.jsx)("div",{className:"d-flex flex-row justify-content-between align-items-center",children:(0,x.jsxs)("div",{className:"d-flex align-items-center fonts13 textLeft",children:[t+1,". ",e]})},t)))]})},t))),(0,x.jsxs)("div",{style:{textAlign:"left"},children:[null===t||void 0===t||null===(n=t.noqrcodeService)||void 0===n?void 0:n.map(((e,t)=>(0,x.jsx)("div",{className:"mb-2",children:(0,x.jsx)("div",{children:(0,x.jsxs)("div",{className:"fonts13 textLeft",style:{fontWeight:"700"},children:[e.category," :"]})})},t))),2!=(null===e||void 0===e?void 0:e.length)&&t.serviceName&&"General Pest Control"!=(null===(i=e[0])||void 0===i?void 0:i.category)&&(0,x.jsx)("div",{className:"mb-2",children:t.serviceName.map(((e,t)=>(0,x.jsx)("div",{className:"d-flex flex-row justify-content-between align-items-center",children:(0,x.jsxs)("div",{className:"d-flex align-items-center fonts13 textLeft",children:[t+1,". ",e]})},t)))})]})]}):(0,x.jsx)("div",{style:{textAlign:"left"},children:(null===t||void 0===t?void 0:t.noqrcodeService)&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:"mb-2",children:(0,x.jsx)("div",{children:(0,x.jsxs)("div",{className:"fonts13 textLeft",style:{fontWeight:"700"},children:[null===t||void 0===t||null===(a=t.noqrcodeService[0])||void 0===a?void 0:a.category," :"]})})}),(0,x.jsx)("div",{className:"mb-2",children:null===t||void 0===t||null===(s=t.noqrcodeService[0])||void 0===s?void 0:s.subCategory.map(((e,t)=>(0,x.jsx)("div",{className:"d-flex flex-row justify-content-between align-items-center",children:(0,x.jsxs)("div",{className:"d-flex align-items-center fonts13 textLeft",children:[t+1,". ",e]})},t)))})]})})})}},{title:"Customer Name",dataIndex:"companyName",width:"13%"},{title:" Technician Name",children:[{title:"Technician Name",dataIndex:"assignedTo",width:"10%",render:(e,t)=>t.technicianDetails&&`${t.technicianDetails.firstName} ${t.technicianDetails.lastName}`},{title:"Technician-2",dataIndex:"otherTechnicianName",width:"10%",editable:!0,render:(e,t)=>{const n=t.otherTechnicianName?t.otherTechnicianName.split(","):[];return(0,x.jsx)(x.Fragment,{children:n.length>0?n.map(((e,t)=>(0,x.jsxs)("div",{children:[t+1,". ",e]},t))):"-"})}}]},{title:"Details",dataIndex:"assignedTo",width:"12%",render:(e,t)=>{var n,i,a;const s=t.technicianStartDate,r=h()(t.startDate).format("DD-MM-YYYY"),l=t.technicianStartTime;f(l);const c=t.completedDetails.endTime;v(c);const o=((e,t)=>{const n=h()(e,"HH:mm:ss"),i=h()(t,"HH:mm:ss"),a=h().duration(i.diff(n)),s=Math.floor(a.asHours()),r=Math.floor(a.asMinutes())%60,l=Math.floor(a.asSeconds())%60;return`${String(s).padStart(2,"0")}:${String(r).padStart(2,"0")}:${String(l).padStart(2,"0")}`})(l,c),d=(null===t||void 0===t||null===(n=t.QrCodeCategory)||void 0===n?void 0:n.length)>0?null===(i=t.QrCodeCategory)||void 0===i?void 0:i.map((e=>e.subCategoryStatus)).flat():null===(a=t.noqrcodeService)||void 0===a?void 0:a.map((e=>e.subCategoryStatus)).flat(),u=[];u.push(d);const m=u[0].map((e=>e.pauseDetails)),g=m.flat(),p=((e,t)=>{const n=h().duration(e),i=h().duration(t),a=n.subtract(i);return`${String(Math.floor(a.asHours())).padStart(2,"0")} Hrs ${String(a.minutes()).padStart(2,"0")} Mins ${String(a.seconds()).padStart(2,"0")} Sec`})(o,(e=>{const t=Math.floor(e/3600),n=Math.floor(e%3600/60),i=e%60;return`${String(t).padStart(2,"0")}:${String(n).padStart(2,"0")}:${String(i).padStart(2,"0")}`})(null===g||void 0===g?void 0:g.reduce(((e,t)=>e+(e=>{const[t,n,i]=e.split(":").map(Number);return 3600*t+60*n+i})(null===t||void 0===t?void 0:t.pauseTiming)),0)));return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{style:{textAlign:"center"},children:[(0,x.jsx)("span",{style:{fontWeight:"600"},children:"Assigned Date :"})," ",r]}),(0,x.jsxs)("div",{style:{textAlign:"center"},children:[(0,x.jsx)("span",{style:{fontWeight:"600"},children:"Completed Date :"})," ",s]}),(0,x.jsxs)("div",{style:{textAlign:"center"},children:[(0,x.jsx)("span",{style:{fontWeight:"600"},children:"Start Time :"})," ",l]}),(0,x.jsxs)("div",{style:{textAlign:"center"},children:[(0,x.jsx)("span",{style:{fontWeight:"600"},children:"End Time:"})," ",t.completedDetails.endTime]}),(0,x.jsxs)("div",{style:{textAlign:"center",marginTop:"10px"},children:[(0,x.jsx)("span",{style:{fontWeight:"600"},children:"Total Working hrs "}),(0,x.jsx)("div",{children:p})]})]})}},{title:"Pause Reason and Time",dataIndex:"pauseReason",width:"12%",render:(e,t)=>{var n,i;const a=(null===t||void 0===t||null===(n=t.QrCodeCategory)||void 0===n?void 0:n.length)>0?t.QrCodeCategory.map((e=>e.subCategoryStatus)).flat():(null===(i=t.noqrcodeService)||void 0===i?void 0:i.map((e=>e.subCategoryStatus)).flat())||[],s=[];s.push(a);const r=s[0].map((e=>null===e||void 0===e?void 0:e.pauseDetails)),l=null===r||void 0===r?void 0:r.flat(),c=l.reduce(((e,t)=>e+(e=>{const[t,n,i]=e.split(":").map(Number);return 3600*t+60*n+i})(t.pauseTiming)),0),o=(d=c,`${Math.floor(d/3600)} Hrs ${Math.floor(d%3600/60)} minutes ${d%60} Sec`);var d;return(0,x.jsxs)("div",{children:[l&&l.map(((e,t)=>(0,x.jsxs)("div",{style:{textAlign:"left"},children:[(0,x.jsxs)("span",{style:{fontWeight:"600"},children:[t+1,"."]}),"  ",e.pauseReason," - ",e.pauseTiming]},t))),(0,x.jsxs)("div",{style:{textAlign:"center ",marginTop:"10px"},children:[(0,x.jsx)("span",{style:{fontWeight:"600"},children:"Total break hrs "}),(0,x.jsx)("div",{children:o})]})]})}},{title:"Chemicals Used",dataIndex:"chemicalsName",width:"12%",render:(e,t)=>{const n=t.completedDetails.chemicalsName;return(0,x.jsx)(x.Fragment,{children:(0,x.jsx)("div",{children:n.join(", ")})})}},{title:"Recommendation",dataIndex:"recommendation",width:"10%",render:(e,t)=>{const n=t.completedDetails.recommendation;return(0,x.jsx)(x.Fragment,{children:(0,x.jsx)("div",{children:n})})}},{title:"Status",dataIndex:"status",width:"10%",fixed:"right",render:()=>(0,x.jsx)(r.ZP,{style:{cursor:"no-drop",backgroundColor:"green",color:"white"},children:"Completed"})}];(0,i.useEffect)((()=>{"Invalid date"===D&&($(null),J())}),[D]);const V=D?null===t||void 0===t?void 0:t.filter((e=>(null===e||void 0===e?void 0:e.technicianStartDate)===D)):t;return(0,x.jsxs)(x.Fragment,{children:["  ",F&&(0,x.jsx)(m.Z,{show:F}),(0,x.jsxs)(a.Z,{title:" Completed Tasks ",children:[(0,x.jsxs)("div",{className:"d-flex justify-content-end",style:{position:"relative",bottom:"10px"},children:[(0,x.jsx)(u.Z,{style:{width:"150px",height:"30px"},placeholder:"Search date",onChange:e=>{$(h()(e).format("DD-MM-YYYY"))},format:"dd-MM-yyyy"}),(0,x.jsx)(c.Z,{onChange:e=>{const i=e.target.value;if(A(i),""===i)J();else{const e=t.filter((e=>e.companyName.toLowerCase().includes(i.toLowerCase())));n(e)}},placeholder:"Search Customer",value:M,style:{width:"150px",height:"35px",marginLeft:"20px"}})]}),(0,x.jsx)(s.Z,{form:e,component:!1,children:(0,x.jsx)(l.Z,{bordered:!0,dataSource:V,columns:K,pagination:{onChange:(e,t)=>{console.log(e,t),q(e),_(t)}},scroll:{x:2e3}})})]})]})}}}]);