"use strict";(self.webpackChunkpest_admin=self.webpackChunkpest_admin||[]).push([[647],{81325:function(e,t,a){var i=a(66585);t.Z={createTechnician:e=>i.Z.Post("technician/createTechnician",e),technicianList:e=>i.Z.Get("technician/getTechnician",e),technicianTask:e=>i.Z.Get("task/getTasks",e),createTechnicianTask:e=>i.Z.Post("task/createTask",e),DeleteTechinician:e=>{let t=`technician/delete/${e}`;return i.Z.Post(t)},DeletedTechnician:e=>i.Z.Get("technician/all/deletedTechnician",e),RestoreTechnician:e=>{const t=`technician/delete/technician/${e}`;return i.Z.Post(t)},TechnicianCount:e=>i.Z.Get("company/totalTechnician",e),StartTaskCount:e=>i.Z.Get("task/start/taskcount",e),OngoingTaskCount:e=>i.Z.Get("task/ongoing/taskcount",e),CompletedTaskCount:e=>i.Z.Get("task/completed/taskcount",e),RegisterTechnicican:e=>i.Z.Post("otherauth/technicianRegister",e),EditTechnician:e=>{const t=`technician/editTechnician/${e.id}`;return i.Z.Post(t,e)},GetReports:e=>i.Z.Get("task/completedTaskDetails/",e),deleteTask:e=>i.Z.Post("task/delete/task",e)}},87647:function(e,t,a){a.r(t);var i=a(47313),n=(a(31046),a(1834)),s=a(33497),c=a(57884),l=a(22834),d=a(71820),r=a(67118),o=a(81325),h=a(70816),x=a.n(h),m=a(86893),u=(a(88379),a(65213)),f=a(41948),v=a(97890),g=a(46417);t.default=()=>{const[e]=c.Z.useForm(),[t,a]=(0,i.useState)([]),[h,j]=(0,i.useState)([]),[y,T]=(0,i.useState)(!1),[k,p]=(0,i.useState)(""),[w,N]=(0,i.useState)(null),[Z,b]=(0,i.useState)(""),D=(0,v.s0)();console.log("data",t),(0,i.useEffect)((()=>{"true"===localStorage.getItem("login")?C():D("/")}),[]);const C=async()=>{T(!0);try{const e=(await o.Z.technicianTask()).data.Results,t=e.reduce(((e,t)=>{var a;return e.push(...null===(a=t.technicians[0])||void 0===a?void 0:a.tasks),e}),[]).sort(((e,t)=>new Date(t.startDate)-new Date(e.startDate)));j(t);const i=t.filter((e=>"start"===e.status&&!1===e.isDelete));a(i)}catch(e){console.error("Error fetching tasks:",e)}finally{T(!1)}};(0,i.useEffect)((()=>{"Invalid date"===w&&(N(null),C())}),[w]),console.log("selectedDate",w);const S=w?null===t||void 0===t?void 0:t.filter((e=>x()(null===e||void 0===e?void 0:e.startDate).format("DD-MM-YYYY")===w)):t,I=[{title:"S.No",dataIndex:"sNo",width:"3%",editable:!0,render:(e,t,a)=>a+1},{title:"Service Name",dataIndex:"QrCodeCategory",width:"8%",render:(e,t)=>{var a,i,n,s;return(0,g.jsx)(g.Fragment,{children:e&&e.length>0?(0,g.jsxs)(g.Fragment,{children:[e.map(((e,t)=>(0,g.jsx)("div",{className:"mb-2",children:(0,g.jsxs)("div",{children:[(0,g.jsxs)("div",{className:"fonts13 textLeft",style:{fontWeight:"700",textAlign:"left"},children:[e.category," :"]}),e.subCategory.map(((e,t)=>(0,g.jsx)("div",{className:"d-flex flex-row justify-content-between align-items-center",children:(0,g.jsxs)("div",{className:"d-flex align-items-center fonts13 textLeft",children:[t+1,". ",e]})},t)))]})},t))),(0,g.jsxs)("div",{style:{textAlign:"left"},children:[null===t||void 0===t||null===(a=t.noqrcodeService)||void 0===a?void 0:a.map(((e,t)=>(0,g.jsx)("div",{className:"mb-2",children:(0,g.jsx)("div",{children:(0,g.jsxs)("div",{className:"fonts13 textLeft",style:{fontWeight:"700"},children:[e.category," :"]})})},t))),2!=(null===e||void 0===e?void 0:e.length)&&t.serviceName&&"General Pest Control"!=(null===(i=e[0])||void 0===i?void 0:i.category)&&(0,g.jsx)("div",{className:"mb-2",children:t.serviceName.map(((e,t)=>(0,g.jsx)("div",{className:"d-flex flex-row justify-content-between align-items-center",children:(0,g.jsxs)("div",{className:"d-flex align-items-center fonts13 textLeft",children:[t+1,". ",e]})},t)))})]})]}):(0,g.jsx)("div",{style:{textAlign:"left"},children:(null===t||void 0===t?void 0:t.noqrcodeService)&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("div",{className:"mb-2",children:(0,g.jsx)("div",{children:(0,g.jsxs)("div",{className:"fonts13 textLeft",style:{fontWeight:"700"},children:[null===t||void 0===t||null===(n=t.noqrcodeService[0])||void 0===n?void 0:n.category," :"]})})}),(0,g.jsx)("div",{className:"mb-2",children:null===t||void 0===t||null===(s=t.noqrcodeService[0])||void 0===s?void 0:s.subCategory.map(((e,t)=>(0,g.jsx)("div",{className:"d-flex flex-row justify-content-between align-items-center",children:(0,g.jsxs)("div",{className:"d-flex align-items-center fonts13 textLeft",children:[t+1,". ",e]})},t)))})]})})})}},{title:" Customer Name",dataIndex:"companyName",width:"8%",editable:!0},{title:" Technician Name",children:[{title:"Technician Name",dataIndex:"assignedTo",width:"8%",render:(e,t)=>t.technicianDetails&&`${t.technicianDetails.firstName} ${t.technicianDetails.lastName}`},{title:"Technician-2",dataIndex:"otherTechnicianName",width:"8%",editable:!0,render:(e,t)=>t.otherTechnicianName?t.otherTechnicianName:"-"}]},{title:"Assigned Date",dataIndex:"startDate",width:"7%",editable:!0,render:e=>x()(e).format("DD-MM-YYYY")},{title:"QR Code Available",dataIndex:"available",width:"10%",editable:!0},{title:"Status",dataIndex:"status",width:"6%",fixed:"right",editable:!0,render:()=>(0,g.jsx)(l.ZP,{style:{cursor:"no-drop",backgroundColor:"#3B5888",color:"white"},children:"Yet to start"})},{title:"Delete",dataIndex:"action",width:"5%",fixed:"right",editable:!0,render:(e,t)=>(0,g.jsx)(l.ZP,{children:(0,g.jsx)(n.IT9,{onClick:()=>(async e=>{T(!0);try{if(!window.confirm("Do you want to delete the task?"))return void T(!1);200===(await o.Z.deleteTask(e)).status?(f.Am.success("Task Deleted Successfully"),C()):f.Am.error("Failed to delete task")}catch(t){console.error("Error deleting technician:",t),f.Am.error("Failed to delete technician")}finally{T(!1)}})(t)})})}],Y=I.map((e=>e.editable?{...e,onCell:t=>({record:t,inputType:"age"===e.dataIndex?"number":"text",dataIndex:e.dataIndex,title:e.title})}:e));return(0,g.jsxs)(g.Fragment,{children:[y&&(0,g.jsx)(u.Z,{show:y}),(0,g.jsxs)(s.Z,{title:" Assigned Tasks ",children:[(0,g.jsxs)("div",{className:"d-flex justify-content-end ",style:{position:"relative",bottom:"10px"},children:[(0,g.jsx)(m.Z,{style:{width:"150px",height:"30px"},placeholder:"Search date",onChange:e=>{console.log("date",e),N(x()(e).format("DD-MM-YYYY"))},format:"dd-MM-yyyy"}),(0,g.jsx)(r.Z,{onChange:e=>{const i=e.target.value;if(b(i),""===i)C();else{const e=t.filter((e=>e.companyName.toLowerCase().includes(i.toLowerCase())));a(e)}},placeholder:"Search Customer",value:Z,style:{width:"150px",height:"35px",marginLeft:"20px"}})]}),(0,g.jsx)(c.Z,{form:e,component:!1,children:(0,g.jsx)(d.Z,{bordered:!0,dataSource:S,columns:Y,pagination:{pageSize:20},scroll:{x:1500}})}),(0,g.jsx)(f.Ix,{})]})]})}}}]);