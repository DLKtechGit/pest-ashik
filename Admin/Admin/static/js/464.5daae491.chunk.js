"use strict";(self.webpackChunkpest_admin=self.webpackChunkpest_admin||[]).push([[464],{92703:function(e,t,a){var n=a(66585);t.Z={AdminLogin:e=>n.Z.Post("adminauth/registeradmin",e),GetAdmins:e=>n.Z.Get("adminauth/getAllAdmins",e),AdminDelete:e=>{const t=`adminauth/admindelete/${e}`;return n.Z.Post(t,e)},AdminCount:e=>n.Z.Get("adminauth/admin/count",e),AdminChildLogin:e=>n.Z.Post("adminauth/login/admin",e),ForgotPassword:e=>n.Z.Post("adminauth/forgot",e),ResetPassword:e=>n.Z.Post("/adminauth/reset/password/:randomString/:expirationTimestmpa",e)}},82464:function(e,t,a){a.r(t);var n=a(47313),i=a(89512),d=a(33497),s=a(1834),l=a(86121),r=a(43690),o=a(57884),c=a(91287),m=a(96892),u=(a(31046),a(67118)),h=a(92703),x=a(41948),p=a(70816),g=a.n(p),f=(a(35508),a(1905),a(65213)),y=a(97890),w=a(46417);const j=e=>{let{editing:t,dataIndex:a,title:n,inputType:i,children:d,...s}=e;const c="number"===i?(0,w.jsx)(l.Z,{}):(0,w.jsx)(r.Z,{});return(0,w.jsx)("td",{...s,children:t?(0,w.jsx)(o.Z.Item,{name:a,style:{margin:0},rules:[{required:!0,message:`Please Input ${n}!`}],children:c}):d})};t.default=()=>{const[e]=o.Z.useForm(),t=(0,y.s0)(),[a,l]=(0,n.useState)(""),[r,p]=(0,n.useState)(""),[Z,A]=(0,n.useState)(""),[v,I]=(0,n.useState)(""),[S,b]=(0,n.useState)(!1),C=(0,n.useRef)(null),k=JSON.parse(localStorage.getItem("userData"));console.log("userData",k),(0,n.useEffect)((()=>{"true"===localStorage.getItem("login")||t("/")}),[]),(0,n.useEffect)((()=>{F()}),[v]);const D=e=>e.key===r,P=()=>{p("")},F=async()=>{var e;b(!0);const t=await h.Z.GetAdmins(),a=(null===t||void 0===t||null===(e=t.data)||void 0===e?void 0:e.Results.map(((e,t)=>({...e,key:e._id,serviceId:(t+1).toString().padStart(3,"0")})))).sort(((e,t)=>new Date(t.created_date)-new Date(e.created_date)));l(a),b(!1)},L=[{title:"S.No",dataIndex:"sNo",width:"5%",editable:!0,render:(e,t,a)=>a+1},{title:"Role",dataIndex:"role",width:"10%",editable:!0},{title:"Email",dataIndex:"email",width:"15%",editable:!1},{title:"Password",dataIndex:"password",width:"15%",editable:!1},{title:"CreatedDate",dataIndex:"created_date",width:"10%",editable:!0,render:e=>g()(e).format("DD-MM-YYYY")},{title:"Action",width:"8%",dataIndex:"operation",render:(t,n)=>D(n)?(0,w.jsxs)("span",{children:[(0,w.jsx)(c.Z.Link,{onClick:()=>(async t=>{try{const n=await e.validateFields(),i=[...a],d=i.findIndex((e=>t===e.key));if(d>-1){const e=i[d];i.splice(d,1,{...e,...n}),l(i),p("")}else i.push(n),l(i),p("")}catch(n){console.log("Validate Failed:",n)}})(n.key),style:{marginRight:8},children:"Save"}),(0,w.jsx)(m.Z,{title:"Sure to cancel?",onConfirm:P,children:(0,w.jsx)("a",{children:"Cancel"})})]}):"childadmin"===n.role&&(0,w.jsx)("div",{className:"d-flex justify-content-center",children:(0,w.jsxs)("span",{style:{cursor:"pointer"},children:[(0,w.jsx)(s.IT9,{onClick:()=>(async e=>{b(!0);try{if(!window.confirm("Are you sure you want to delete ?"))return void b(!1);const t=await h.Z.AdminDelete(e);t&&200===t.status?(x.Am.success("Admin Deleted Successfully"),I(t.data)):x.Am.error("Failed to delete Admin")}catch(t){console.error("Error deleting Admin:",t),x.Am.error("Failed to delete Admin")}finally{b(!1)}})(n._id)}),console.log("record",n)]})})}].map((e=>e.editable?{...e,onCell:t=>({record:t,inputType:"age"===e.dataIndex?"number":"text",dataIndex:e.dataIndex,title:e.title,editing:D(t)})}:e));return(0,w.jsxs)(w.Fragment,{children:[S&&(0,w.jsx)(f.Z,{show:S}),(0,w.jsx)(d.Z,{title:"Manage Child Admins",children:"superadmin"===k.role?(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("div",{className:"d-flex justify-content-end ",style:{position:"relative",bottom:"10px"},children:(0,w.jsx)(u.Z,{onChange:e=>{const t=e.target.value;if(A(t),""===t)F();else{const e=a.filter((e=>e.email.toLocaleLowerCase().includes(t.toLocaleLowerCase())));l(e)}},placeholder:"Search by email",value:Z,style:{width:"150px",marginLeft:"20px"}})}),(0,w.jsx)(o.Z,{form:e,component:!1,children:(0,w.jsx)("div",{ref:C,children:(0,w.jsx)(i.Z,{components:{body:{cell:j}},bordered:!0,dataSource:a,columns:L,rowClassName:"editable-row",pagination:!1,scroll:{y:500}})})})]}):(0,w.jsx)(c.Z,{variant:"body1",color:"textSecondary",className:"d-flex justify-content-center",style:{color:"grey"},children:"This feature is only available for superAdmin."})}),(0,w.jsx)(x.Ix,{})]})}}}]);