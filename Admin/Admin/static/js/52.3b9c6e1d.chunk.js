"use strict";(self.webpackChunkpest_admin=self.webpackChunkpest_admin||[]).push([[52],{81325:function(e,t,a){var n=a(66585);t.Z={createTechnician:e=>n.Z.Post("technician/createTechnician",e),technicianList:e=>n.Z.Get("technician/getTechnician",e),technicianTask:e=>n.Z.Get("task/getTasks",e),createTechnicianTask:e=>n.Z.Post("task/createTask",e),DeleteTechinician:e=>{let t=`technician/delete/${e}`;return n.Z.Post(t)},DeletedTechnician:e=>n.Z.Get("technician/all/deletedTechnician",e),RestoreTechnician:e=>{const t=`technician/delete/technician/${e}`;return n.Z.Post(t)},TechnicianCount:e=>n.Z.Get("company/totalTechnician",e),StartTaskCount:e=>n.Z.Get("task/start/taskcount",e),OngoingTaskCount:e=>n.Z.Get("task/ongoing/taskcount",e),CompletedTaskCount:e=>n.Z.Get("task/completed/taskcount",e),RegisterTechnicican:e=>n.Z.Post("otherauth/technicianRegister",e),EditTechnician:e=>{const t=`technician/editTechnician/${e.id}`;return n.Z.Post(t,e)},GetReports:e=>n.Z.Get("task/completedTaskDetails/",e),deleteTask:e=>n.Z.Post("task/delete/task",e)}},7052:function(e,t,a){a.r(t);var n=a(47313),s=a(91287),i=a(96892),c=a(1834),l=a(33497),r=a(86121),d=a(43690),o=a(57884),m=a(71820),h=(a(31046),a(81325)),u=a(67118),x=a(41948),N=a(70816),j=a.n(N),p=a(3463),f=a(79429),Z=a(29385),g=a(24655),b=a.n(g),y=(a(5978),a(65213)),T=a(44057),k=a(97890),w=a(46417);const v=e=>{let{editing:t,dataIndex:a,title:n,inputType:s,children:i,...c}=e;const l="number"===s?(0,w.jsx)(r.Z,{}):(0,w.jsx)(d.Z,{});return(0,w.jsx)("td",{...c,children:t?(0,w.jsx)(o.Z.Item,{name:a,style:{margin:0},rules:[{required:!0,message:`Please Input ${n}!`}],children:l}):i})};t.default=()=>{const[e,t]=(0,n.useState)(!1),[a,r]=(0,n.useState)(!1),[d]=o.Z.useForm(),[N,g]=(0,n.useState)(""),[C,S]=(0,n.useState)(""),[I,F]=(0,n.useState)(""),[L,D]=(0,n.useState)(""),[P,_]=(0,n.useState)(""),[E,q]=(0,n.useState)(""),[G,A]=(0,n.useState)(""),[R,$]=(0,n.useState)(""),[B,Y]=(0,n.useState)(!1),[M,V]=(0,n.useState)(!1),[H,J]=(0,n.useState)(""),O=(0,k.s0)();(0,n.useEffect)((()=>{"true"===localStorage.getItem("login")||O("/")}),[]),(0,n.useEffect)((()=>{U()}),[L]);console.log("cusId",H);const U=async()=>{Y(!0);try{const e=(await h.Z.technicianList()).data.Results,t=e.filter((e=>!1===e.deleted)).sort(((e,t)=>new Date(t.created_date)-new Date(e.created_date)));g(t)}catch(e){console.log(e)}finally{Y(!1)}},W=e=>e.key===C,z=()=>{S("")},K=[{title:"S.No",dataIndex:"sNo",width:"5%",editable:!0,render:(e,t,a)=>a+1},{title:"FirstName",dataIndex:"firstName",width:"10%",editable:!0},{title:"LastName",dataIndex:"lastName",width:"10%",editable:!0},{title:"Phone",dataIndex:"phone",width:"12%",editable:!0,render:(e,t)=>`${t.phoneNumber}`},{title:"Email",dataIndex:"email",width:"20%",editable:!0},{title:"Created Date",dataIndex:"created_date",width:"15%",editable:!0,render:e=>j()(e).format("DD-MM-YYYY")},{title:"Action",width:"10%",dataIndex:"action",fixed:"right",render:(e,a)=>W(a)?(0,w.jsxs)("span",{children:[(0,w.jsx)(s.Z.Link,{style:{marginRight:8},children:"Save"}),(0,w.jsx)(i.Z,{title:"Sure to cancel?",onConfirm:z,children:(0,w.jsx)("a",{children:"Cancel"})})]}):(0,w.jsxs)("div",{className:"d-flex gap-3 justify-content-center",children:[(0,w.jsx)(s.Z.Link,{disabled:""!==C,onClick:()=>(async(e,a,n,s,i)=>{r(e),_(n),q(s),A(a),$(i),t(!0)})(a._id,a.email,a.lastName,a.firstName,a.phoneNumber),children:(0,w.jsx)(c.yl5,{})}),(0,w.jsx)("span",{children:(0,w.jsx)(s.Z.Link,{children:(0,w.jsx)(c.IT9,{onClick:()=>{return e=a._id,V(!0),void J(e);var e}})})})]})}].map((e=>e.editable?{...e,onCell:t=>({record:t,inputType:"age"===e.dataIndex?"number":"text",dataIndex:e.dataIndex,title:e.title,editing:W(t)})}:e));return(0,w.jsxs)(w.Fragment,{children:["  ",B&&(0,w.jsx)(y.Z,{show:B}),(0,w.jsxs)(l.Z,{title:"Manage Technicians ",children:[(0,w.jsx)("div",{className:"d-flex justify-content-end ",style:{position:"relative",bottom:"10px"},children:(0,w.jsx)(u.Z,{onChange:e=>{const t=e.target.value;if(F(t),""===t)U();else{const e=N.filter((e=>e.firstName.toLowerCase().includes(t.toLowerCase())));g(e)}},placeholder:"Search by name",value:I,style:{width:"150px",marginLeft:"20px"}})}),(0,w.jsx)(o.Z,{form:d,component:!1,children:(0,w.jsx)(m.Z,{components:{body:{cell:v}},bordered:!0,dataSource:N,columns:K,rowClassName:"editable-row",pagination:{onChange:z},scroll:{x:1500}})}),(0,w.jsxs)(Z.Z,{className:"modal d-flex align-items-center",show:e,onHide:()=>{t(!1)},children:[(0,w.jsx)(Z.Z.Header,{className:"modalhead",closeButton:!0,children:(0,w.jsx)(Z.Z.Title,{children:"Edit Technician"})}),(0,w.jsx)(Z.Z.Body,{className:"modalbody",children:(0,w.jsx)("div",{children:(0,w.jsx)(w.Fragment,{children:(0,w.jsx)(f.J9,{initialValues:{id:a,firstName:E,lastName:P,email:G,phoneNumber:R,submit:null},validationSchema:p.Ry().shape({firstName:p.Z_().required("First Name is required"),lastName:p.Z_().required("Last Name is required"),email:p.Z_().email("Invalid email format").required("Email is required"),phoneNumber:p.Z_().required("Phone number is required")}),children:e=>{let{values:a,setFieldValue:n,isValid:s,dirty:i}=e;return(0,w.jsxs)(o.Z,{children:[(0,w.jsxs)("div",{className:"d-flex flex-row",children:[(0,w.jsxs)("div",{className:"col-6 p-2",children:[(0,w.jsx)("label",{htmlFor:"firstName",className:"",children:"FirstName"}),(0,w.jsx)(f.gN,{name:"firstName",type:"text",className:"newcompany form-control mt-3",placeholder:"Enter First Name"}),(0,w.jsx)(f.Bc,{name:"firstName",component:"div",className:"text-danger mt-2"})]}),(0,w.jsxs)("div",{className:"col-6 p-2",children:[(0,w.jsx)("label",{htmlFor:"lastName",className:"",children:"LastName"}),(0,w.jsx)(f.gN,{name:"lastName",type:"text",className:"newcompany form-control mt-3",placeholder:"Enter Last Name"}),(0,w.jsx)(f.Bc,{name:"lastName",component:"div",className:"text-danger mt-2"})]})]}),(0,w.jsx)("div",{className:"d-flex flex-row ",children:(0,w.jsxs)("div",{className:"col-6 p-2",children:[(0,w.jsx)("label",{htmlFor:"phoneNumber",className:" mb-3",children:"Phone Number"}),(0,w.jsx)(b(),{country:"bh",value:a.phoneNumber,onChange:e=>{e.startsWith("+")||(e="+"+e),n("phoneNumber",e)}})]})}),(0,w.jsx)("div",{className:"col-4 mt-4",children:(0,w.jsx)("div",{className:"col-4 mt-4",children:(0,w.jsx)("button",{type:"submit",onClick:()=>(async e=>{Y(!0);try{const a=await h.Z.EditTechnician(e);console.log("res:",a),200==a.status?(x.Am.success(a.data.message),t(!1)):x.Am.error(a.data.message),U()}catch(a){x.Am.error(a)}finally{Y(!1)}})(a),className:"btn tech-btn",disabled:!(s&&i),children:"Update"})})})]})}})})})})]}),(0,w.jsx)(T.Z,{modalTitle:"Delete Technician",modalContent:"Are you sure want to delete Technician?",show:M,onClose:()=>{V(!1),J("")},onConfirm:async()=>{const e=H;Y(!0);try{const t=await h.Z.DeleteTechinician(e);console.log("deletedTechnician",t),200===t.status?(x.Am.success("Technician Deleted successfully"),U()):x.Am.error("Failed to delete technician")}catch(t){console.error("Error deleting technician:",t),x.Am.error("Failed to delete technician")}finally{Y(!1),V(!1)}}}),(0,w.jsx)(x.Ix,{})]})]})}}}]);